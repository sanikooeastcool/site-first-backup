this.itsec=this.itsec||{},this.itsec["user-security-check"]=this.itsec["user-security-check"]||{},this.itsec["user-security-check"].dashboard=(window.itsecWebpackJsonP=window.itsecWebpackJsonP||[]).push([[37],{"1ZqX":function(e,t){!function(){e.exports=this.wp.data}()},"5Kuv":function(e,t,r){},FqII:function(e,t){!function(){e.exports=this.wp.date}()},GRId:function(e,t){!function(){e.exports=this.wp.element}()},K9lf:function(e,t){!function(){e.exports=this.wp.compose}()},Mmq9:function(e,t){!function(){e.exports=this.wp.url}()},RxS6:function(e,t){!function(){e.exports=this.wp.keycodes}()},Tqx9:function(e,t){!function(){e.exports=this.wp.primitives}()},TvNi:function(e,t){!function(){e.exports=this.wp.plugins}()},YLtl:function(e,t){!function(){e.exports=this.lodash}()},cDcd:function(e,t){!function(){e.exports=this.React}()},elev:function(e,t,r){"use strict";r.r(t);var c=r("GRId"),n=r("l3Sj"),s=r("TvNi"),a=r("1ZqX"),i=r("ppSj"),o=r("RIqP"),u=r.n(o),l=r("J4zp"),d=r.n(l),b=r("YLtl"),f=r("TSYQ"),m=r.n(f),O=r("tI+e"),p=r("K9lf"),h=r("g56x"),j=r("gf1k"),_=r("49++"),y=r("yXPU"),v=r.n(y),E=r("o0o1"),w=r.n(E),g=r("FqII"),N=r("ywyh"),x=r.n(N),I=r("Td6G");function k(e){switch(e){case"enabled":return["yes",Object(n.__)("Enabled","it-l10n-ithemes-security-pro")];case"not-enabled":return["no-alt",Object(n.__)("Not Enabled","it-l10n-ithemes-security-pro")];case"not-available":return["no-alt",Object(n.__)("Module Inactive","it-l10n-ithemes-security-pro")];case"enforced-not-configured":return["minus",Object(n.__)("Enforced, Not Configured","it-l10n-ithemes-security-pro")];default:return["minus",e]}}function S(e){switch(e){case 0:case 1:return["short",Object(n._x)("Very Weak","password strength","it-l10n-ithemes-security-pro")];case 2:return["bad",Object(n._x)("Weak","password strength","it-l10n-ithemes-security-pro")];case 3:return["good",Object(n._x)("Medium","password strength","it-l10n-ithemes-security-pro")];case 4:return["strong",Object(n._x)("Strong","password strength","it-l10n-ithemes-security-pro")];default:return["unknown",Object(n._x)("Unknown","password strength","it-l10n-ithemes-security-pro")]}}function L(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object(i.a)(Object(c.useCallback)((function(r){return x()({url:null==e?void 0:e.href,method:Object(b.isArray)(null==e?void 0:e.methods)?null==e?void 0:e.methods[0]:null==e?void 0:e.methods,parse:!1,data:r}).then((function(e){return null==t||t(e),I.b.fromResponse(e)})).catch(function(){var e=v()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e){throw e},e.next=3,I.b.fromResponse(t);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),r),s=n.execute,a=n.status,o=n.value,u=n.error;return C(a,o,u),{execute:s,status:a,value:o,error:u}}function C(e,t,r){var s=Object(a.useDispatch)("core/notices"),i=s.createNotice,o=s.removeNotice,u=function(e,t){var r=Object(b.uniqueId)("security-profile-action");i(e,t,{context:"ithemes-security",id:r}),setTimeout((function(){return o(r,"ithemes-security")}),5e3)};Object(c.useEffect)((function(){if("error"===e){var c=Object(I.o)(r.error).join(" ");i("error",c||Object(n.__)("An unknown error occurred.","it-l10n-ithemes-security-pro"),{context:"ithemes-security"})}else"success"===e&&(t.success.length>0&&u("success",t.success.join(" ")),t.info.length>0&&u("info",t.info.join(" ")),t.warning.length>0&&u("warning",t.warning.join(" ")))}),[e,t,r])}function P(e){var t=e.card,r=e.user;return Object(c.createElement)("section",{className:"itsec-card-security-profile__user-info"},Object(c.createElement)("table",null,Object(c.createElement)("tbody",null,Object(c.createElement)("tr",null,Object(c.createElement)("th",null,Object(n.__)("Role","it-l10n-ithemes-security-pro")),Object(c.createElement)("td",null,r.role)),Object(c.createElement)("tr",null,Object(c.createElement)("th",null,Object(n.__)("Password Strength","it-l10n-ithemes-security-pro")),Object(c.createElement)("td",null,Object(c.createElement)("span",{className:m()("itsec-card-security-profile__password-strength","itsec-card-security-profile__password-strength--".concat(S(r.password_strength)[0]))},S(r.password_strength)[1]))),r.password_last_changed&&Object(c.createElement)("tr",null,Object(c.createElement)("th",null,Object(n.__)("Password Age","it-l10n-ithemes-security-pro")),Object(c.createElement)("td",null,Object(c.createElement)("span",{title:Object(g.dateI18n)("M d, Y g:s A",r.password_last_changed.time)},r.password_last_changed.diff))),Object(c.createElement)("tr",null,Object(c.createElement)("th",null,Object(n.__)("Two-Factor","it-l10n-ithemes-security-pro")),Object(c.createElement)("td",null,k(r.two_factor)[1])),r.last_active&&Object(c.createElement)("tr",null,Object(c.createElement)("th",null,Object(n.__)("Last Seen","it-l10n-ithemes-security-pro")),Object(c.createElement)("td",null,Object(c.createElement)("span",{title:Object(g.dateI18n)("M d, Y g:s A",r.last_active.time)},r.last_active.diff))))),Object(c.createElement)(D,{card:t,user:r}))}function D(e){var t=e.card,r=e.user;return Object(c.createElement)("div",{className:"itsec-card-security-profile__user-actions"},Object(c.createElement)(R,{card:t,user:r}),Object(c.createElement)(q,{card:t,user:r}))}function R(e){var t,r,s,a=e.card,o=e.user,u=null===(t=a._links)||void 0===t||null===(r=t["ithemes-security:send-2fa-reminder"])||void 0===r||null===(s=r[0])||void 0===s?void 0:s.href,l=Object(i.a)(Object(c.useCallback)((function(){return x()({url:u.replace("{user_id}",o.id),parse:!1,method:"POST"}).then(I.b.fromResponse).catch(function(){var e=v()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e){throw e},e.next=3,I.b.fromResponse(t);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),!1),d=l.execute,b=l.status;return C(b,l.value,l.error),!u||"enforced-not-configured"!==o.two_factor&&"not-enabled"!==o.two_factor?null:Object(c.createElement)(O.Button,{isSmall:!0,isPrimary:!0,isBusy:"pending"===b,onClick:d},Object(n.__)("Send Two-Factor Reminder","it-l10n-ithemes-security-pro"))}function q(e){var t,r,s,a=e.card,o=e.user,u=null===(t=a._links)||void 0===t||null===(r=t["ithemes-security:logout"])||void 0===r||null===(s=r[0])||void 0===s?void 0:s.href,l=Object(i.a)(Object(c.useCallback)((function(){return x()({url:u.replace("{user_id}",o.id),parse:!1,method:"POST"}).then(I.b.fromResponse).catch(function(){var e=v()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e){throw e},e.next=3,I.b.fromResponse(t);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),!1),d=l.execute,b=l.status;return C(b,l.value,l.error),u?Object(c.createElement)(O.Button,{isSmall:!0,isSecondary:!0,isBusy:"pending"===b,onClick:d},Object(n.__)("Force Logout","it-l10n-ithemes-security-pro")):null}function T(e){var t=e.master;return Object(c.createElement)(React.Fragment,null,Object(c.createElement)("td",{className:"itsec-card-security-profile__users--column-avatar"},Object(c.createElement)("img",{src:t.avatar,alt:""})),Object(c.createElement)("th",{scope:"row",className:"itsec-card-security-profile__users--column-username"},t.name),Object(c.createElement)("td",{className:"itsec-card-security-profile__users--column-role"},t.role),Object(c.createElement)("td",{className:"itsec-card-security-profile__users--column-two-factor"},Object(c.createElement)(O.Dashicon,{icon:k(t.two_factor)[0]}),Object(c.createElement)("span",{className:"screen-reader-text"},k(t.two_factor)[1])))}function F(e){var t=e.master,r=e.pinUser,s=e.profileCards,a=e.card;return Object(c.createElement)("section",{className:"itsec-card-security-profile__user"},Object(c.createElement)("header",{className:"itsec-card-security-profile__user-header"},Object(c.createElement)("img",{src:t.avatar,alt:""}),Object(c.createElement)("h3",null,t.name),!s.includes(t.id)&&Object(c.createElement)(O.Button,{isLink:!0,onClick:function(){return r(t.id)}},Object(n.__)("Pin","it-l10n-ithemes-security-pro"))),Object(c.createElement)(P,{user:t,card:a}))}function A(e){var t,r=e.context,s=Object(p.useInstanceId)(A,"itsec-card-security-profile__filter-roles"),i=Object(a.useSelect)((function(e){return{roles:e("ithemes-security/core").getRoles(),config:e("ithemes-security/dashboard").getAvailableCard(r.card),isQuerying:e("ithemes-security/dashboard").isQueryingDashboardCard(r.id)}}),[r.id,r.card]),o=i.roles,l=i.config,f=i.isQuerying,h=Object(a.useDispatch)("ithemes-security/dashboard").queryDashboardCard,j=Object(c.useCallback)((function(e,t){h(r.id,{search:e,roles:t})}),[r.id]),y=Object(p.useDebounce)(j,300),v=Object(c.useState)(""),E=d()(v,2),w=E[0],g=E[1],N=Object(c.useState)(!1),x=d()(N,2),I=x[0],k=x[1],S=Object(c.useState)((null===(t=l.query_args.roles)||void 0===t?void 0:t.default)||[]),L=d()(S,2),C=L[0],P=L[1];return Object(c.useEffect)((function(){return y(w,C)}),[w,C]),Object(c.createElement)("div",{className:m()("itsec-card-security-profile__filter",{"itsec-card-security-profile__filter--roles-visible":I,"itsec-card-security-profile__filter--has-roles":l.query_args.roles})},Object(c.createElement)("div",{className:"itsec-card-security-profile__filter-search"},Object(c.createElement)(O.TextControl,{label:Object(n.__)("Search Users","it-l10n-ithemes-security-pro"),hideLabelFromVision:!0,placeholder:Object(n.__)("Search"),value:w,onChange:g}),f?Object(c.createElement)(O.Spinner,null):Object(c.createElement)(O.Dashicon,{icon:"search"})),l.query_args.roles&&Object(c.createElement)(O.Button,{icon:"filter",onClick:function(){return k(!I)},"aria-expanded":I,"aria-controls":s},Object(n.sprintf)(Object(n.__)("Roles (%d)","it-l10n-ithemes-security-pro"),C.length)),I&&Object(c.createElement)("ul",{id:s},Object(b.map)(o,(function(e,t){return Object(c.createElement)("li",{key:t},Object(c.createElement)(_.f,{label:e.label,checked:C.includes(t),onChange:function(e){return P(e?[].concat(u()(C),[t]):Object(b.without)(C,t))}}))}))))}function B(e){var t,r,n,s,i=e.context,o=Object(a.useDispatch)("ithemes-security/dashboard").refreshDashboardCard,u=null===(t=i._links)||void 0===t||null===(r=t["ithemes-security:force-password-change"])||void 0===r?void 0:r[0],l=null===(n=i._links)||void 0===n||null===(s=n["ithemes-security:clear-password-change"])||void 0===s?void 0:s[0],d=L(u,(function(){return o(i.id)}),!1),b=d.execute,f=d.status,m=L(l,(function(){return o(i.id)}),!1),O=m.execute,p=m.status;return u?Object(c.createElement)("footer",{className:"itsec-card-security-profile__footer"},Object(c.createElement)(_.x,{isSmall:!0,isPrimary:!0,isBusy:"pending"===f||"pending"===p,text:u.title,onClick:function(){return b()},controls:[l&&{title:l.title,onClick:function(){O()}}]})):null}var M={render:Object(p.compose)([Object(p.withState)({selected:0}),p.withInstanceId,Object(a.withDispatch)((function(e,t){return{pinUser:function(r){e("ithemes-security/dashboard").saveDashboardCard(t.dashboardId,{card:"security-profile",settings:{user:r}})}}})),Object(a.withSelect)((function(e,t){return{profileCards:e("ithemes-security/dashboard").getDashboardCards(t.dashboardId).filter((function(e){return"security-profile"===e.card})).map((function(e){return Object(b.get)(e,["data","user","id"])}))}}))])((function(e){var t=e.card,r=e.config,s=e.eqProps,a=e.profileCards,o=e.pinUser,u=e.selected,l=e.setState,d=Object(i.m)({pinUser:o,profileCards:a,card:t})(F),b=function(e){return l({selected:e})},f=s["max-width"]&&s["max-width"].includes("500px");return Object(c.createElement)("div",{className:"itsec-card--type-security-profile-list"},Object(c.createElement)(j.CardHeader,null,Object(c.createElement)(j.MasterDetailBack,{isSmall:f,select:b,selectedId:u}),Object(c.createElement)(j.CardHeaderTitle,{card:t,config:r}),Object(c.createElement)(j.CardHeaderStatus,null)),Object(c.createElement)(j.MasterDetail,{masters:t.data.users,detailRender:d,masterRender:T,ListHeader:A,ListFooter:B,selectedId:u,select:b,isSmall:f,context:t},Object(c.createElement)("thead",null,Object(c.createElement)("tr",null,Object(c.createElement)("th",{className:"itsec-card-security-profile__users--column-avatar"},Object(c.createElement)("span",{className:"screen-reader-text"},Object(n.__)("Avatar","it-l10n-ithemes-security-pro"))),Object(c.createElement)("th",{className:"itsec-card-security-profile__users--column-username"},Object(n.__)("Username","it-l10n-ithemes-security-pro")),Object(c.createElement)("th",{className:"itsec-card-security-profile__users--column-role"},Object(n.__)("Role","it-l10n-ithemes-security-pro")),Object(c.createElement)("th",{className:"itsec-card-security-profile__users--column-two-factor"},Object(n.__)("2FA","it-l10n-ithemes-security-pro"))))))})),elementQueries:[{type:"width",dir:"max",px:500},{type:"width",dir:"min",px:501},{type:"width",dir:"max",px:700}]};Object(h.addFilter)("ithemes-security.dashboard.getCardTitle.security-profile","ithemes-security/security-profile/default",(function(e,t){return t.data.user&&t.data.user.name?Object(n.sprintf)(Object(n.__)("Security Profile – %s","it-l10n-ithemes-security-pro"),t.data.user.name):t.settings&&t.settings.user?Object(n.sprintf)(Object(n.__)("User (%d) Security Profile","it-l10n-ithemes-security-pro"),t.settings.user):e}));var U=r("lSNA"),H=r.n(U),Q=r("Mmq9");function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,c)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){H()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=function(e){return new Promise((function(t,r){x()({path:Object(Q.addQueryArgs)("/wp/v2/users",{search:e,per_page:100,itsec_global:!0})}).then((function(e){return t(e.map((function(e){return{value:e.id,label:e.name}})))})).catch(r)}))};var G=Object(p.compose)([Object(p.withState)({userInput:0}),Object(a.withDispatch)((function(e,t){return{unPin:function(){return e("ithemes-security/dashboard").removeDashboardCard(t.dashboardId,t.card)},save:function(r){return e("ithemes-security/dashboard").saveDashboardCard(t.dashboardId,r)}}}))])((function(e){var t=e.card,r=e.save,s=e.userInput,a=e.setState;return Object(c.createElement)("section",{className:"itsec-card-security-profile__select-user"},Object(c.createElement)("label",{htmlFor:"itsec-card-security-profile__select-user-dropdown--".concat(t.id)},Object(n.__)("Select a User","it-l10n-ithemes-security-pro")),Object(c.createElement)("form",{className:"itsec-card-security-profile__select-form"},Object(c.createElement)(_.c,{addErrorBoundary:!1,className:"itsec-card-security-profile__select-user-dropdown",classNamePrefix:"itsec-card-security-profile__select-user-dropdown",inputId:"itsec-card-security-profile__select-user-dropdown--".concat(t.id),cacheOptions:!0,defaultOptions:!0,loadOptions:K,value:s,onChange:function(e){return a({userInput:e})},maxMenuHeight:150}),Object(c.createElement)("div",{className:"itsec-card-security-profile__select-user-save-container"},Object(c.createElement)(O.Button,{onClick:function(){return r(Y(Y({},t),{},{settings:Y(Y({},t.settings||{}),{},{user:s.value})}))}},Object(n.__)("Select","it-l10n-ithemes-security-pro")))),Object(c.createElement)("p",{className:"description"},Object(n.__)("Select a user to monitor with this card.","it-l10n-ithemes-security-pro")))}));r("5Kuv");var J={render:Object(p.compose)([Object(a.withSelect)((function(e,t){return{canEdit:e("ithemes-security/dashboard").canEditCard(t.dashboardId,t.card.id)}}))])((function(e){var t=e.card,r=e.config,n=e.canEdit,s=e.dashboardId,a=t.data.user;return Object(c.createElement)("div",{className:"itsec-card--type-security-profile"},a&&Object(c.createElement)("section",{className:"itsec-card-security-profile__user"},Object(c.createElement)("header",{className:"itsec-card-security-profile__user-header itsec-card__drag-handle"},Object(c.createElement)("img",{src:a.avatar,alt:""}),Object(c.createElement)("h3",null,a.name)),Object(c.createElement)(P,{user:a,card:t})),!a&&Object(c.createElement)(c.Fragment,null,Object(c.createElement)(j.CardHeader,null,Object(c.createElement)(j.CardHeaderTitle,{card:t,config:r})),n&&Object(c.createElement)(G,{card:t,dashboardId:s})))})),elementQueries:[{type:"width",dir:"max",px:250}]};function X(){var e=Object(a.useDispatch)("ithemes-security/dashboard").registerCard;return Object(i.g)(X,(function(){e("security-profile-list",M),e("security-profile",J)})),null}r.p=window.itsecWebpackPublicPath,Object(n.setLocaleData)({"":{}},"ithemes-security-pro"),Object(s.registerPlugin)("itsec-user-security-check-dashboard",{render:function(){return Object(c.createElement)(X,null)}})},faye:function(e,t){!function(){e.exports=this.ReactDOM}()},g56x:function(e,t){!function(){e.exports=this.wp.hooks}()},gf1k:function(e,t){!function(){e.exports=this.itsec.dashboard.dashboard}()},l3Sj:function(e,t){!function(){e.exports=this.wp.i18n}()},rl8x:function(e,t){!function(){e.exports=this.wp.isShallowEqual}()},"tI+e":function(e,t){!function(){e.exports=this.wp.components}()},ywyh:function(e,t){!function(){e.exports=this.wp.apiFetch}()},z1rk:function(e,t){!function(){e.exports=this.itsec.packages.data}()}},[["elev",0,5,1,4,2,3]]]);